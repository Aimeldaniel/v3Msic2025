<?php
$selected = $_GET['code'] ?? '';
?>
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>MSIC Compare | MSIC 2008 ‚Üî 2025 Mapping</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Modern UI Styles -->
<style>
:root{
  --teal:#0fa3a3;
  --dark:#09121f;
  --bg:#f5f7fa;
  --card:#fff;
  --muted:#708090;
  --radius:12px;
  --shadow:0 8px 22px rgba(0,0,0,0.06);
  --font: Inter, system-ui, -apple-system, "Segoe UI", Roboto;
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  background:var(--bg);
  font-family:var(--font);
  color:#0b1a2b;
  line-height:1.5;
  padding-bottom:60px;
}

/* Header */
header {
  background: #0F97A3;
  padding: 15px 50px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid #eee;
  position: sticky;
  top: 0;
  z-index: 1000;
}

/* Logo Container */
.logo {
  display: flex;
  align-items: center;
  gap: 14px;
}

/* Logo Icon (Emoji / SVG) */
.logo-icon {
  font-size: 48px; /* Make icon bigger */
  line-height: 1; /* Prevent vertical misalignment */
}

/* If using an <img> instead of emoji */
.logo img {
  width: 55px; /* Resize image logo */
  height: auto;
}

/* Logo Text */
.logo h1,
.logo small {
  color: #ffffff !important; /* Make text white */
  margin: 0;
}

.logo h1 {
  font-size: 20px;
  font-weight: 700;
}

.logo small {
  font-size: 12px;
  opacity: 0.85;
}

/* NAVIGATION */
nav ul {
  display: flex;
  list-style: none;
  gap: 30px;
}

nav ul li a {
  text-decoration: none;
  color: #fff;
  font-weight: 500;
}

nav ul li a:hover {
  color: var(--dosm-secondary);
}

/* LANGUAGE BUTTONS */
.lang-toggle,
.lang {
  display: flex;
  gap: 10px;
}

.lang-toggle button,
.lang .lang-btn {
  border: 1px solid rgba(255, 255, 255, 0.15);
  background: #f1f1f1;
  padding: 6px 12px;
  border-radius: 15px;
  cursor: pointer;
  font-size: 14px;
}

.lang-toggle button.active {
  background: var(--dosm-secondary);
  color: #fff;
}

/* Container */
.container{
  max-width:1100px;
  margin:30px auto;
  padding:0 16px;
}

/* =========================================
   Feature Cards
========================================= */
.cards {
  display: flex;
  gap: 18px;
  justify-content: space-between;
  margin-bottom: 26px;
}

.card {
  flex: 1;
  background: var(--card);
  padding: 20px;
  border-radius: 12px;
  box-shadow: var(--shadow-md);
  transition: transform 0.18s ease, box-shadow 0.18s ease;
  text-align: left;
}

.card:hover {
  transform: translateY(-6px);
}

.card .icon {
  font-size: 28px;
  margin-bottom: 8px;
}

.card h3 {
  margin: 8px 0 6px;
}

.card p {
  font-size: 14px;
  margin-bottom: 20px;
}

.card button {
  border: none;
  padding: 10px 18px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  font-weight: bold;
  background: ;
  background: #0072ce;
  color: #fff;
}

.card:nth-child(2) button {
  background: #006d5b;
}

.card:nth-child(3) button {
  background: #333;
}

/* ======= Search section ======= */
.search-section h2 {
  margin: 0 0 6px;
  font-size: 22px;
}
.search-section .muted {
  color: var(--muted);
  margin-bottom: 10px;
}
.search-panel {
  display: flex;
  gap: 12px;
  background: var(--card);
  padding: 16px;
  border-radius: 14px;
  box-shadow: var(--shadow-md);
  align-items: center;
  flex-wrap: wrap;
}
.search-panel input[type="search"] {
  flex: 1;
  min-width: 220px;
  padding: 12px 14px;
  border-radius: 10px;
  border: 1px solid #e7eef2;
  font-size: 15px;
}
.search-actions {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}
.btn {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 12px;
  border-radius: 10px;
  border: none;
  background: #eef2f4;
  color: #071428;
  cursor: pointer;
  font-weight: 700;
}
.btn.primary {
  background: var(--dosm-secondary);
  color: #fff;
}
.btn.ghost {
  background: transparent;
  border: 1px solid #e6edf0;
}

/* Card section */
.section-card{
  background:var(--card);
  padding:22px;
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  margin-bottom:26px;
}

/* Inputs + Buttons */
input{
  width:100%;
  padding:12px 14px;
  border-radius:10px;
  border:1px solid #dce3e8;
  font-size:15px;
  margin-bottom:14px;
}
.btn{
  padding:10px 18px;
  border:none;
  border-radius:10px;
  cursor:pointer;
  font-size:14px;
}
.btn-primary{
  background:var(--teal);
  color:#fff;
}
.btn-secondary{
  background:#eef2f4;
  color:#061019;
}

.search-actions{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}

/* Table */
.table-wrap{
  margin-top:20px;
  background:var(--card);
  padding:14px;
  border-radius:var(--radius);
  box-shadow:var(--shadow);
}

.msic-table{
  width:100%;
  border-collapse:collapse;
  font-size:15px;
}

.msic-table th{
  background:#f0f5f5;
  padding:12px;
  text-align:left;
  font-weight:600;
  border-bottom:2px solid #e8eeee;
}

.msic-table td{
  padding:12px;
  border-bottom:1px solid #f1f4f6;
}

.msic-table tr:hover{
  background:#f7fbfb;
}

/* Back */
.back-link{
  display:inline-block;
  margin-top:16px;
  text-decoration:none;
  color:var(--teal);
  font-weight:600;
}
</style>
</head>

<body>

<header>
  <div class="logo">
    <div class="logo-icon">
  <svg width="55" height="55" viewBox="0 0 24 24" fill="white" xmlns="http://www.w3.org/2000/svg">
  <path d="M12 2L3 7V9H21V7L12 2Z" fill="white"/>
  <path d="M5 10H7V19H5V10Z" fill="white"/>
  <path d="M9 10H11V19H9V10Z" fill="white"/>
  <path d="M13 10H15V19H13V10Z" fill="white"/>
  <path d="M17 10H19V19H17V10Z" fill="white"/>
  <path d="M3 20H21V22H3V20Z" fill="white"/>
</svg>
</div>
    <div>
      <h1 style="color: white;">Ministry of Economy</h1>
      <small style="color: white;">Department of Statistics Malaysia</small>
    </div>
  </div>
  <nav>
    <ul>
      <li><a href="index.php">Home</a></li>
      <li><a href="index.php">About MSIC</a></li>
      <li><a href="index.php">Search</a></li>
      <li><a href="compare.php">Compare</a></li>
    </ul>
  </nav>
  <div class="lang-toggle">
    <button id="btnEN" class="active">EN</button>
    <button id="btnBM">BM</button>
  </div>
</header>

<main class="container">
  <!-- Features -->
<main class="container">
<section class="features"><br>
  <h2>Explore MSIC Database</h2>
  <p>Access comprehensive industrial classification data with our advanced search and comparison tools.</p>

  <div class="cards">
    <div class="card">
      <div class="icon">üîç</div>
      <h3>Search MSIC Codes</h3>
      <p>Find industry classifications using keywords, codes or descriptions.</p>
      <button class="btn" onclick="window.location.href='index.php'">Start Search</button>
    </div>

    <div class="card">
      <div class="icon">üìä</div>
      <h3>Compare Classifications</h3>
      <p>Compare MSIC 2008 ‚Üî MSIC 2025 mappings</p>
      <button class="btn" onclick="window.location.href='compare.php'">Compare Now</button>
    </div>

    <div class="card">
      <div class="icon">‚öôÔ∏è</div>
      <h3>Advanced Settings</h3>
      <p>Customize search parameters</p>
      <button id="configure" class="btn">Configure</button>
    </div>
  </div>
</section>

  <!-- Search Box -->
  <div class="section-card">
    <h2>Search Mapping</h2>
    <p class="muted" style="margin-bottom:12px;color:var(--muted);">
      Type a code or keyword (e.g. "01111" or "Agriculture")
    </p>

    <input id="cmpq" 
           placeholder="Search MSIC..."
           value="<?php echo htmlspecialchars($selected); ?>" />

    <div class="search-actions">
      <button id="cmpSearch" class="btn btn-primary">Compare</button>
      <button id="cmpSearch" class="btn btn-secondary"><- Click here for Lists Comparison</button>
    </div>
  </div>

  <!-- Table Results -->
  <div class="table-wrap">
    <table class="msic-table">
      <thead>
        <tr>
          <th>Section</th>
          <th>MSIC 2008</th>
          <th>Description 2008</th>
          <th>MSIC 2025</th>
          <th>Description 2025</th>
        </tr>
      </thead>
      <tbody id="cmpBody"></tbody>
    </table>
  </div>

  <a href="index.php" class="back-link">‚Üê Back to MSIC Search</a>

</main>

<!-- JS (same logic as yours, only formatted cleaner) -->
<script>
document.getElementById('cmpSearch').addEventListener('click', async ()=>{
  const q = document.getElementById('cmpq').value.trim();
  const res = await fetch(`api.php?action=compare&code=${encodeURIComponent(q)}`);
  const data = await res.json();
  const t = document.getElementById('cmpBody');
  t.innerHTML = '';

  (data.items || []).forEach(r=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${escapeHtml(r['SECTION MSIC 2025']||'')}</td>
      <td>${escapeHtml(r['MSIC 2008']||'')}</td>
      <td>${escapeHtml(r['DESCRIPTION MSIC 2008']||'')}</td>
      <td>${escapeHtml(r['MSIC 2025']||'')}</td>
      <td>${escapeHtml(r['DESCRIPTION 2025']||'')}</td>
    `;
    t.appendChild(tr);
  });
});

document.getElementById('downloadMap').addEventListener('click', ()=>{
  const q = document.getElementById('cmpq').value.trim();
  window.location = `api.php?action=export_compare&code=${encodeURIComponent(q)}`;
});

// Auto-load if prefilled
(function(){
  const initial = document.getElementById('cmpq').value.trim();
  if(initial) document.getElementById('cmpSearch').click();
})();

function escapeHtml(s){
  return (s||'').toString().replace(/[&<>"']/g, m=>({
    '&':'&amp;',
    '<':'&lt;',
    '>':'&gt;',
    '"':'&quot;',
    "'":'&#39;'
  }[m]));
}
</script>

</body>
</html>
